close all
clear all
A=(randn(4,8)+1i.*randn(4,8));
W2_2=[1 0;0 1];
W4_4=[0.5 0.5 0.5 0.5; 0.5 0.5 -0.5 -0.5; 0.5 -0.5 0.5 -0.5;0.5 -0.5 -0.5 0.5];
%W4_4=[0.5 -0.5i -0.5 0.5i;0.5i 0.5 0.5i 0.5;-0.5 -0.5i 0.5 0.5i;-0.5i 0.5 -0.5i 0.5];
W8_8=kron(W2_2',W4_4');
P(:,1)=W8_8(:,1);
P(:,2)=W8_8(:,3);
P(:,3)=W8_8(:,5);
P(:,4)=W8_8(:,7);
P=P*.1/2;
Ap=P*A;
H=(randn(2,8)+1i.*randn(2,8));
Ah=H*Ap;
G=H*P;
F=G'*inv(G*G');
An=F*Ah;

